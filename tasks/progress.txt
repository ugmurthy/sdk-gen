## Codebase Patterns
- Use ESM modules (`"type": "module"` in package.json)
- CLI entry point is `src/cli.ts` using Commander.js
- Run `npm run typecheck` to verify TypeScript types
- Run `npm run build` to compile to `dist/`
- `openapi-types` package provides TypeScript types for OpenAPI specs
- SwaggerParser.validate() parses and validates in one step
- `src/extractor.ts` extracts operations/schemas via `extractAll(spec)`
- Templates in `src/templates/typescript/*.hbs`, copied to dist during build
- `src/templates/index.ts` provides `renderInterfaces()`, `renderZodSchemas()`, `renderClient()`
- `src/generator.ts` provides `generateTypeScriptSDK()` and `writeGeneratedFiles()`
- Generated TS code must use `.js` extensions in imports for NodeNext compatibility
- Test generated code typecheck: create temp project with axios, zod deps and run tsc

---

## 2026-01-28 - US-001
Thread: https://ampcode.com/threads/T-019c050f-ef5c-71cb-9c77-3ac0022ede44
- Implemented project setup and CLI scaffold
- Files changed: package.json, tsconfig.json, src/cli.ts, .gitignore
- **Learnings for future iterations:**
  - Commander.js `requiredOption()` enforces mandatory flags
  - Use `fileURLToPath` for ESM `__dirname` equivalent
  - Project uses NodeNext module resolution
---

## 2026-01-28 - US-002
Thread: https://ampcode.com/threads/T-019c050f-ef5c-71cb-9c77-3ac0022ede44
- Implemented OpenAPI spec parsing and validation
- Files changed: src/parser.ts, src/cli.ts, test-fixtures/petstore.yaml, test-fixtures/invalid.yaml
- **Learnings for future iterations:**
  - swagger-parser returns typed OpenAPI.Document, cast to OpenAPIV3/V3_1
  - Test fixtures in `test-fixtures/` directory for manual testing
  - Error handling wraps swagger-parser errors with user-friendly messages
---

## 2026-01-28 - US-003
Thread: https://ampcode.com/threads/T-019c050f-ef5c-71cb-9c77-3ac0022ede44
- Implemented extractor module for operations and schemas
- Files changed: src/extractor.ts, src/cli.ts, test-fixtures/streaming.yaml
- **Learnings for future iterations:**
  - `extractAll()` returns { operations, schemas } from OpenAPISpec
  - Operations derive operationId from method+path if not provided
  - Streaming detection via content types: text/event-stream (SSE), application/x-ndjson (NDJSON)
  - ExtractedOperation includes pathParameters, queryParameters, requestBody, responseSchema, isStreaming
---

## 2026-01-28 - US-004
Thread: https://ampcode.com/threads/T-019c050f-ef5c-71cb-9c77-3ac0022ede44
- Created Handlebars templates for TypeScript code generation
- Files changed: src/templates/index.ts, src/templates/typescript/*.hbs, package.json
- **Learnings for future iterations:**
  - swagger-parser dereferences $refs - use schema fingerprinting to match dereferenced objects to names
  - `setSchemaMap()` must be called before `openApiTypeToTs()` to enable schema name matching
  - Build script must copy `.hbs` files to dist: `tsc && cp -r src/templates dist/`
  - Templates: interfaces.hbs (TS types), zod-schemas.hbs (runtime validation), client.hbs (API client class)
---

## 2026-01-28 - US-005
Thread: https://ampcode.com/threads/T-019c051a-541f-7094-8eb7-182f7ae0988a
- Implemented TypeScript SDK generation with file output
- Files changed: src/generator.ts (new), src/cli.ts, src/templates/typescript/client.hbs, src/templates/typescript/zod-schemas.hbs
- **Learnings for future iterations:**
  - Use `'{' + 'paramName' + '}'` in Handlebars to output literal braces (triple braces render unescaped)
  - ESM imports require `.js` extensions in generated code for NodeNext resolution
  - Don't duplicate type exports - types.ts has interfaces, schemas.ts only exports Zod schemas
  - `generateTypeScriptSDK()` in generator.ts returns array of GeneratedFile objects
  - CLI prompts for confirmation before overwriting; use `--force` to skip
---
