## Codebase Patterns
- Use ESM modules (`"type": "module"` in package.json)
- CLI entry point is `src/cli.ts` using Commander.js
- Run `npm run typecheck` to verify TypeScript types
- Run `npm run build` to compile to `dist/`
- `openapi-types` package provides TypeScript types for OpenAPI specs
- SwaggerParser.validate() parses and validates in one step
- `src/extractor.ts` extracts operations/schemas via `extractAll(spec)`
- Templates in `src/templates/typescript/*.hbs` and `src/templates/python/*.hbs`, copied to dist during build
- `src/templates/index.ts` provides `renderInterfaces()`, `renderZodSchemas()`, `renderClient()` for TS and `renderPythonModels()`, `renderPythonClient()` for Python
- `src/generator.ts` provides `generateTypeScriptSDK()` and `writeGeneratedFiles()`
- Generated TS code must use `.js` extensions in imports for NodeNext compatibility
- Test generated code typecheck: create temp project with axios, zod deps and run tsc
- Use `{{{...}}}` triple braces in Handlebars for TypeScript types with `<>` characters

---

## 2026-01-28 - US-001
Thread: https://ampcode.com/threads/T-019c050f-ef5c-71cb-9c77-3ac0022ede44
- Implemented project setup and CLI scaffold
- Files changed: package.json, tsconfig.json, src/cli.ts, .gitignore
- **Learnings for future iterations:**
  - Commander.js `requiredOption()` enforces mandatory flags
  - Use `fileURLToPath` for ESM `__dirname` equivalent
  - Project uses NodeNext module resolution
---

## 2026-01-28 - US-002
Thread: https://ampcode.com/threads/T-019c050f-ef5c-71cb-9c77-3ac0022ede44
- Implemented OpenAPI spec parsing and validation
- Files changed: src/parser.ts, src/cli.ts, test-fixtures/petstore.yaml, test-fixtures/invalid.yaml
- **Learnings for future iterations:**
  - swagger-parser returns typed OpenAPI.Document, cast to OpenAPIV3/V3_1
  - Test fixtures in `test-fixtures/` directory for manual testing
  - Error handling wraps swagger-parser errors with user-friendly messages
---

## 2026-01-28 - US-003
Thread: https://ampcode.com/threads/T-019c050f-ef5c-71cb-9c77-3ac0022ede44
- Implemented extractor module for operations and schemas
- Files changed: src/extractor.ts, src/cli.ts, test-fixtures/streaming.yaml
- **Learnings for future iterations:**
  - `extractAll()` returns { operations, schemas } from OpenAPISpec
  - Operations derive operationId from method+path if not provided
  - Streaming detection via content types: text/event-stream (SSE), application/x-ndjson (NDJSON)
  - ExtractedOperation includes pathParameters, queryParameters, requestBody, responseSchema, isStreaming
---

## 2026-01-28 - US-004
Thread: https://ampcode.com/threads/T-019c050f-ef5c-71cb-9c77-3ac0022ede44
- Created Handlebars templates for TypeScript code generation
- Files changed: src/templates/index.ts, src/templates/typescript/*.hbs, package.json
- **Learnings for future iterations:**
  - swagger-parser dereferences $refs - use schema fingerprinting to match dereferenced objects to names
  - `setSchemaMap()` must be called before `openApiTypeToTs()` to enable schema name matching
  - Build script must copy `.hbs` files to dist: `tsc && cp -r src/templates dist/`
  - Templates: interfaces.hbs (TS types), zod-schemas.hbs (runtime validation), client.hbs (API client class)
---

## 2026-01-28 - US-005
Thread: https://ampcode.com/threads/T-019c051a-541f-7094-8eb7-182f7ae0988a
- Implemented TypeScript SDK generation with file output
- Files changed: src/generator.ts (new), src/cli.ts, src/templates/typescript/client.hbs, src/templates/typescript/zod-schemas.hbs
- **Learnings for future iterations:**
  - Use `'{' + 'paramName' + '}'` in Handlebars to output literal braces (triple braces render unescaped)
  - ESM imports require `.js` extensions in generated code for NodeNext resolution
  - Don't duplicate type exports - types.ts has interfaces, schemas.ts only exports Zod schemas
  - `generateTypeScriptSDK()` in generator.ts returns array of GeneratedFile objects
  - CLI prompts for confirmation before overwriting; use `--force` to skip
---

## 2026-01-28 - US-006
Thread: https://ampcode.com/threads/T-019c051f-6ce8-75fd-987a-c3a5b0490f68
- Implemented TypeScript streaming methods for SSE and NDJSON endpoints
- Files changed: src/templates/typescript/client.hbs, src/templates/index.ts, src/extractor.ts
- **Learnings for future iterations:**
  - Use `{{{...}}}` triple braces in Handlebars for types containing special chars like `<>` to avoid HTML escaping
  - Streaming methods use native fetch API (not axios) for proper ReadableStream support
  - `isSse` boolean added to TemplateOperation for template conditionals
  - SSE parsing: split on `\n\n`, then extract `data:` lines
  - NDJSON parsing: split on `\n`, parse each complete line
  - AbortSignal support via optional `signal` parameter
  - `extractResponseSchema()` now checks SSE/NDJSON content types for streaming schemas
---

## 2026-01-29 - US-007
Thread: https://ampcode.com/threads/T-019c076b-e90a-7068-b543-0db72a7a953d
- Created Handlebars templates for Python code generation
- Files changed: src/templates/python/models.hbs, src/templates/python/client.hbs, src/templates/index.ts
- **Learnings for future iterations:**
  - Added `openApiTypeToPython()` function for converting OpenAPI types to Python type hints
  - Added `toSnakeCase()` helper for Python naming conventions
  - `TemplateSchemaProperty` and `TemplateParameter` now include `snakeName` and `pythonType`
  - Python templates use `model_validate()` for Pydantic v2 validation
  - List responses use list comprehension: `[Model.model_validate(item) for item in response.json()]`
  - Added `isListResponse` flag to `TemplateOperation` for proper array validation handling
  - Request body serialization: `body.model_dump() if hasattr(body, 'model_dump') else body`
---

## 2026-01-29 - US-008
Thread: https://ampcode.com/threads/T-019c0771-e6e0-71a3-a947-ab5202989895
- Implemented Python SDK generation with Pydantic models and Requests client
- Files changed: src/generator.ts, src/cli.ts
- **Learnings for future iterations:**
  - `generatePythonSDK()` returns GeneratedFile[] with models.py, client.py, __init__.py
  - Python __init__.py needs `__all__` for proper exports
  - Streaming endpoints are skipped in non-streaming client (handled in US-009)
  - Test with mypy: create venv, install mypy pydantic requests types-requests, run `mypy --strict`
---
